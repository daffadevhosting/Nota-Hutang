---
layout: default
title: Catat Hutang
permalink: /catat
---

<div class="app-container">
  <h2>Catat Hutang</h2>
<div class="input-grup">
  <input type="text" id="nama" placeholder="Nama" />
  <input type="number" id="jumlah" placeholder="Jumlah (Rp)" />
  <input type="date" id="tanggalPinjam" />
  <input type="date" id="jatuhTempo" />
</div>
  <button onclick="tambahHutang()">Tambah Hutang</button>

  <h3>Daftar Hutang</h3>
  <div id="daftarHutang"></div>
<button id="logout" onclick="logout()">Logout</button>
</div>
  
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
    // Ganti dengan konfigurasi Firebase kamu
 const firebaseConfig = {
  apiKey: "AIzaSyCiT9DTiVun4mKJAenmEHkhZ9jrjNMTEZs",
  authDomain: "notahutangmu.firebaseapp.com",
  projectId: "notahutangmu",
  storageBucket: "notahutangmu.appspot.com",
  messagingSenderId: "978954750002",
  appId: "1:978954750002:web:4dd533087767ef08b4d42b",
  measurementId: "G-54WD1L6R9Q",
};

// Inisialisasi Firebase
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
function showAlert(pesan) {
  alert(pesan); // Ganti sesuai kebutuhan, bisa pakai custom UI
}
// Cek status autentikasi
auth.onAuthStateChanged(user => {
  if (!user) {
    window.location.href = "/";
  } else {
    tampilkanHutang(); // tampilkan hanya setelah user login
  }
});

// Fungsi untuk menambah hutang
async function tambahHutang() {
  const nama = document.getElementById("nama").value.trim();
  const jumlah = parseInt(document.getElementById("jumlah").value);
  const tanggalPinjam = document.getElementById("tanggalPinjam").value;
  const jatuhTempo = document.getElementById("jatuhTempo").value;

  // Validasi input
  if (!nama || isNaN(jumlah) || !tanggalPinjam || !jatuhTempo) {
    showAlert("Harap isi semua kolom dengan benar!");
    return;
  }

  try {
    // Tambahkan data ke Firestore
await db.collection('hutang').add({
  uid: auth.currentUser.uid, // tambahkan ini
  nama,
  jumlah,
  tanggalPinjam,
  jatuhTempo,
  status: 'belum lunas'
});

    showAlert("Hutang berhasil ditambahkan!");

    // Reset form
    document.getElementById("nama").value = "";
    document.getElementById("jumlah").value = "";
    document.getElementById("tanggalPinjam").value = "";
    document.getElementById("jatuhTempo").value = "";
  } catch (error) {
    console.error("Gagal menambah hutang:", error);
    showAlert("Terjadi kesalahan saat menambah hutang.");
  }
}

// Fungsi untuk menampilkan daftar hutang
async function tampilkanHutang() {
  const container = document.getElementById('daftarHutang');
  container.innerHTML = '';

  const user = auth.currentUser;
  if (!user) return;

  const snapshot = await db.collection('hutang')
    .where('uid', '==', user.uid)
    .orderBy('jatuhTempo')
    .get();

  snapshot.forEach(doc => {
    const data = doc.data();
    const div = document.createElement('div');
    div.className = 'hutang-item';
    div.innerHTML = `
      <strong>${data.nama}</strong><br/>
      Jumlah: Rp ${data.jumlah.toLocaleString()}<br/>
      Pinjam: ${data.tanggalPinjam}<br/>
      Jatuh Tempo: ${data.jatuhTempo}<br/>
      Status: ${data.status}
    `;
    container.appendChild(div);
  });
}

async function logout() {
  try {
    await auth.signOut(); // Proses logout
    showAlert("Anda telah logout.");
    window.location.href = "/"; // Redirect ke halaman login
  } catch (error) {
    console.error("Gagal logout:", error);
    showAlert("Terjadi kesalahan saat logout.");
  }
}
  </script>